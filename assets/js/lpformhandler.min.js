$(document).ready(e=>{$.fn.setCursorPosition=function(e){if($(this).get(0).setSelectionRange)$(this).get(0).setSelectionRange(e,e);else if($(this).get(0).createTextRange){var t=$(this).get(0).createTextRange();t.collapse(!0),t.moveEnd("character",e),t.moveStart("character",e),t.select()}},$('[name="phone"]').click(function(){$(this).setCursorPosition(4)}),$('[name="phone"]').mask("+7 (999) 999-99-99");let t=localStorage.getItem("scrollPrev"),a=localStorage.getItem("pagePrev");t&&a===location.pathname&&(window.scrollTo(0,+t),localStorage.removeItem("scrollPrev"),localStorage.removeItem("pagePrev"));let n=!1,l=$("form"),o=$('input[type="file"]'),r=$("#wrongPhone, #wrongEmail");const i=(e,t)=>{let a=$(t).find(`[name=${e}]`),l=a.siblings(`label[for="${e}"]`);n={label:{color:l.css("color")},field:{border:a.css("border")}};let o=a.css("border-width");l[0]&&(l[0].style.color="#ff4f4f"),"0px"!=o&&a[0]?a[0].style.border=`${o} solid #ff4f4f`:a[0]&&(a[0].style.border="2px solid #ff4f4f")},s=(e,t)=>{let a=$(t).find(`[name=${e}]`),l=a.siblings(`label[for="${e}"]`);n&&(l[0]&&(l[0].style.color=n.label.color),a[0]&&(a[0].style.border=n.field.border))},m=e=>{const t=window.location.search.substring(1).split("&");for(let a=0;a<t.length;a++){let n=t[a].split("=");if(n[0]==e)return n[1]}return""};if(l.submit(e=>{let t=e.target,a=t.elements,n=$(t).find('button[type="submit"]'),l=a.easydata,o={},r=[],c="undefined"!=typeof pageName&&0!=pageName?pageName:"noname page";if(""!=l.value)return e.preventDefault(),!1;for(let e of a)void 0!==e.dataset.required&&r.push(e.name);for(let n of r){if(""==a[n].value)return e.preventDefault(),i(n,t),!1;""!=a[n].value&&s(n,t)}n.prop("disabled",!0);let f=new Date;f={day:f.getDate(),month:f.getMonth()+1,year:f.getFullYear(),hours:f.getHours(),minutes:f.getMinutes(),seconds:f.getSeconds()};for(let e in f)f[e]<10&&(f[e]="0"+f[e]);a.date.value=`${f.day}.${f.month}.${f.year}, ${f.hours}:${f.minutes}:${f.seconds}`,a.pagefrom.value=`${c}`,a.pagefromlink.value=location.pathname,a.utm_source.value=m("utm_source"),a.utm_campaign.value=m("utm_campaign"),a.utm_content.value=m("utm_content"),a.utm_term.value=m("utm_term"),document.referrer&&""!=document.referrer&&(a.referal.value=document.referrer);for(let e of a)"text"!==e.type&&"email"!==e.type&&"tel"!==e.type||(o[e.name]=e.value);let u={name:o.name,phone:o.phone,email:o.email};sessionStorage.setItem("clientInfo",JSON.stringify(u)),localStorage.setItem("scrollPrev",window.scrollY),localStorage.setItem("pagePrev",location.pathname)}),"/thankyou/"==location.pathname){let e=JSON.parse(sessionStorage.getItem("clientInfo"));if(e){let t=$("#wrongPhone"),a=$("#wrongEmail");e.name&&($("#clname").text(`${e.name},`),t.find('[name="name"]').val(e.name),a.find('[name="name"]').val(e.name)),e.phone&&($("#clphone").text(`${e.phone}`),t.find('[name="phone"]').val(e.phone),a.find('[name="phone"]').val(e.phone)),e.email&&($("#clemail").text(`${e.email}`),$(".successmail").fadeIn(),$(".info-section").fadeIn(),t.find('[name="email"]').val(e.email),a.find('[name="email"]').val(e.email))}}r.submit(e=>{let t=$(e.target).find('[name="name"]')[0].value,a=$(e.target).find('[name="phone"]')[0].value,n=$(e.target).find('[name="email"]')[0].value,l=JSON.stringify({name:t,phone:a,email:n});sessionStorage.setItem("clientInfo",l)}),$(".upload").click(function(e){e.preventDefault(),$(this).find('input[type="file"]').click()}),o.click(e=>e.stopImmediatePropagation()),o.change(function(){this.files[0].size>6e6&&(alert("Файл слишком большой! Размер файла должен быть не больше 6 Мб"),this.value="")})});